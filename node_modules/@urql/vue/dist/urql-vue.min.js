var e=require("@urql/core"),u=require("vue"),t=require("wonka");function r(){return(r=Object.assign||function(e){for(var u=1;u<arguments.length;u++){var t=arguments[u];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function n(t,r){var n;n=u.isRef(r)?r:u.ref(r instanceof e.Client?r:new e.Client(r)),t.provide("$urql",n)}function a(){return u.inject("$urql")}function i(e){return e&&u.isRef(e)?e.value:e}var o={flush:"pre"};function s(n,s,c){void 0===s&&(s=a()),void 0===c&&(c=[]);var f=u.reactive(n),l=u.ref(),v=u.ref(!1),p=u.ref(!1),b=u.ref(),h=u.ref(),x=u.ref(),d=u.isRef(n.pause)?n.pause:u.ref(!!n.pause),y=u.ref(e.createRequest(f.query,i(f.variables))),q=u.ref();c.push(u.watchEffect((function(){var u=e.createRequest(f.query,i(f.variables));y.value.key!==u.key&&(y.value=u)}),o)),c.push(u.watchEffect((function(){q.value=d.value?void 0:s.value.executeQuery(y.value,r({},{requestPolicy:f.requestPolicy},f.context))}),o));var w={data:l,stale:v,error:b,operation:h,extensions:x,fetching:p,isPaused:d,executeQuery:function(e){var u=q.value=s.value.executeQuery(y.value,r({},{requestPolicy:f.requestPolicy},f.context,e));return r({},P,{then:function(e,r){return new Promise((function(e){var r=!1,n=t.subscribe((function(){w.fetching.value||w.stale.value||(n&&n.unsubscribe(),r=!0,e(w))}))(u);r&&n.unsubscribe()})).then(e,r)}})},pause:function(){d.value=!0},resume:function(){d.value=!1}};c.push(u.watchEffect((function(e){q.value?(p.value=!0,v.value=!1,e(t.subscribe((function(e){l.value=e.data,v.value=!!e.stale,p.value=!1,b.value=e.error,h.value=e.operation,x.value=e.extensions}))(t.onEnd((function(){p.value=!1,v.value=!1}))(q.value)).unsubscribe)):(p.value=!1,v.value=!1)}),{flush:"sync"}));var P=r({},w,{then:function(e,u){return new Promise((function(e){if(!q.value)return e(w);var u=!1,r=t.subscribe((function(){w.fetching.value||w.stale.value||(r&&r.unsubscribe(),u=!0,e(w))}))(q.value);u&&r.unsubscribe()})).then(e,u)}});return P}function c(r,n){void 0===n&&(n=a());var o=u.ref(),s=u.ref(!1),c=u.ref(!1),f=u.ref(),l=u.ref(),v=u.ref();return{data:o,stale:s,fetching:c,error:f,operation:l,extensions:v,executeMutation:function(u,a){return c.value=!0,t.toPromise(t.take(1)(n.value.executeMutation(e.createRequest(r,i(u)),a||{}))).then((function(e){return o.value=e.data,s.value=!!e.stale,c.value=!1,f.value=e.error,l.value=e.operation,v.value=e.extensions,e}))}}}var f={flush:"pre"};function l(n,o,s,c){void 0===s&&(s=a()),void 0===c&&(c=[]);var l=u.reactive(n),v=u.ref(),p=u.ref(!1),b=u.ref(!1),h=u.ref(),x=u.ref(),d=u.ref(),y=u.ref(o),q=u.isRef(n.pause)?n.pause:u.ref(!!n.pause),w=u.ref(e.createRequest(l.query,i(l.variables))),P=u.ref();c.push(u.watchEffect((function(){var u=e.createRequest(l.query,i(l.variables));w.value.key!==u.key&&(w.value=u)}),f)),c.push(u.watchEffect((function(){P.value=q.value?void 0:s.value.executeSubscription(w.value,r({},l.context))}),f)),c.push(u.watchEffect((function(e){P.value?(b.value=!0,e(t.subscribe((function(e){b.value=!0,v.value=void 0!==e.data&&"function"==typeof y.value?y.value(v.value,e.data):e.data,h.value=e.error,d.value=e.extensions,p.value=!!e.stale,x.value=e.operation}))(t.onEnd((function(){b.value=!1}))(P.value)).unsubscribe)):b.value=!1}),f));var R={data:v,stale:p,error:h,operation:x,extensions:d,fetching:b,isPaused:q,executeSubscription:function(e){return P.value=s.value.executeSubscription(w.value,r({},l.context,e)),R},pause:function(){q.value=!0},resume:function(){q.value=!1}};return R}exports.default=n,exports.install=n,exports.provideClient=function(t){var r;return r=u.isRef(t)?t:u.ref(t instanceof e.Client?t:new e.Client(t)),u.provide("$urql",r),r.value},exports.useClientHandle=function(){var e=a(),t=[];return u.onBeforeUnmount((function(){for(var e;e=t.shift();)e()})),{client:e.value,useQuery:function(u){return s(u,e,t)},useSubscription:function(u,r){return l(u,r,e,t)},useMutation:function(u){return c(u,e)}}},exports.useMutation=function(e){return c(e)},exports.useQuery=function(e){return s(e)},exports.useSubscription=function(e,u){return l(e,u)},Object.keys(e).forEach((function(u){"default"===u||exports.hasOwnProperty(u)||(exports[u]=e[u])}));
//# sourceMappingURL=urql-vue.min.js.map
